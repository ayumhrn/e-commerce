var cov_qnbo6jmjj=function(){var path="/home/ayumhrn/Glint-task/MP_2/e_commerce2/services/nodemailer.js";var hash="cd4cd46f831054e9129c5ccbd981c0a8519683f2";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/ayumhrn/Glint-task/MP_2/e_commerce2/services/nodemailer.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:38}},"1":{start:{line:2,column:25},end:{line:2,column:55}},"2":{start:{line:3,column:0},end:{line:3,column:27}},"3":{start:{line:5,column:18},end:{line:9,column:1}},"4":{start:{line:11,column:10},end:{line:11,column:33}},"5":{start:{line:12,column:11},end:{line:12,column:36}},"6":{start:{line:13,column:41},end:{line:13,column:71}},"7":{start:{line:15,column:0},end:{line:36,column:1}},"8":{start:{line:16,column:22},end:{line:16,column:58}},"9":{start:{line:17,column:4},end:{line:19,column:5}},"10":{start:{line:18,column:8},end:{line:18,column:73}},"11":{start:{line:20,column:18},end:{line:25,column:6}},"12":{start:{line:27,column:4},end:{line:35,column:37}},"13":{start:{line:34,column:20},end:{line:34,column:83}},"14":{start:{line:35,column:22},end:{line:35,column:35}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:15,column:28},end:{line:15,column:29}},loc:{start:{line:15,column:50},end:{line:36,column:1}},line:15},"1":{name:"(anonymous_1)",decl:{start:{line:34,column:14},end:{line:34,column:15}},loc:{start:{line:34,column:20},end:{line:34,column:83}},line:34},"2":{name:"(anonymous_2)",decl:{start:{line:35,column:15},end:{line:35,column:16}},loc:{start:{line:35,column:22},end:{line:35,column:35}},line:35}},branchMap:{"0":{loc:{start:{line:17,column:4},end:{line:19,column:5}},type:"if",locations:[{start:{line:17,column:4},end:{line:19,column:5}},{start:{line:17,column:4},end:{line:19,column:5}}],line:17}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"cd4cd46f831054e9129c5ccbd981c0a8519683f2"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var nodemailer=(cov_qnbo6jmjj.s[0]++,require('nodemailer'));var nodemailersendGrid=(cov_qnbo6jmjj.s[1]++,require('nodemailer-sendgrid'));cov_qnbo6jmjj.s[2]++;require('dotenv').config();var transporter=(cov_qnbo6jmjj.s[3]++,nodemailer.createTransport(nodemailersendGrid({apiKey:process.env.SENDGRID_API_KEY})));var jwt=(cov_qnbo6jmjj.s[4]++,require('jsonwebtoken'));var user=(cov_qnbo6jmjj.s[5]++,require('../models/user'));var{successResponse,errorResponse}=(cov_qnbo6jmjj.s[6]++,require('../helpers/response'));cov_qnbo6jmjj.s[7]++;exports.sendResetPassword=async(email,res)=>{cov_qnbo6jmjj.f[0]++;const userExist=(cov_qnbo6jmjj.s[8]++,await user.findOne({email:email}));cov_qnbo6jmjj.s[9]++;if(!userExist){cov_qnbo6jmjj.b[0][0]++;cov_qnbo6jmjj.s[10]++;return res.status(404).json(errorResponse('Not found',err,404));}else{cov_qnbo6jmjj.b[0][1]++;}const token=(cov_qnbo6jmjj.s[11]++,jwt.sign({_id:userExist._id,email:userExist.email},process.env.SECRET_KEY,{algorithm:'HS256'}));cov_qnbo6jmjj.s[12]++;transporter.sendMail({from:'no-reply@ga.com',to:email,subject:'Reset Password',html:`<p>Klik link dibawah ini untuk reset password</p>
        <a href="http://localhost:3000/user/reset/${token}" target="_blank">Reset Password</a>`}).then(()=>{cov_qnbo6jmjj.f[1]++;cov_qnbo6jmjj.s[13]++;return res.status(200).json(successResponse(`Email sent to ${email}`));}).catch(err=>{cov_qnbo6jmjj.f[2]++;cov_qnbo6jmjj.s[14]++;return res.send(err);});};